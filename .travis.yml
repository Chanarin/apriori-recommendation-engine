language: php

dist: trusty
sudo: required

php:
  - 7.0

before_script:
 - mv travis.env
 - mysql -e 'create database mysql;'
 - composer self-update
 - composer install --dev --prefer-source --no-interaction
 - chmod -R 777 app/storage
 - php artisan migrate:install --env=testing --no-interaction -vvv

script:
 - php artisan migrate --env=testing --no-interaction -vvv
 - php artisan db:seed --env=testing --no-interaction -vvv
 - vendor/bin/codecept run functional
 - php artisan migrate:rollback --env=testing --no-interaction -vvv

services:
  - redis-server
  - mysql

script: vendor/bin/phpunit
